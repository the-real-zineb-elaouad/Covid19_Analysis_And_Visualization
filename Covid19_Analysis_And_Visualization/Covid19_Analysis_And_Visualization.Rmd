---
title: "*COVID-19 - Analyse et Visualisation*"

author: |
  *R√©alis√© par :*  
  EL AOUAD Zineb  
  DIALLO Mamadou Aliou  
  DIALLO Sadou  
  DOSSO Siaka  
  EL HIRI Salah Eddine

date: "`r format(Sys.Date(), '%d %B %Y')`"

output:
  pdf_document:
    toc: true
    toc_depth: 2
    number_sections: true
    highlight: tango
    latex_engine: xelatex
    includes:
      in_header: preambule.tex

fontsize: 11pt
geometry: margin=1in
# runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,     
  warning = FALSE,
  message = FALSE   
)

```

# Introduction

Notre √©tude porte sur l‚Äôanalyse comparative de l‚Äô√©volution de la COVID-19 des pays d‚ÄôEurope les plus impact√©s, que sont la **France**, l‚Äô**Allemagne**, le **Royaume-Uni**, l‚Äô**Italie** et la **Russie**.  
L‚Äôobservation est faite sur la p√©riode de **2020 √† 2024**.

Dans le contexte de notre √©tude, nous avons proc√©d√© par **phases** :

- La premi√®re phase a consist√© au **traitement des donn√©es**.  
- La derni√®re phase a concern√© **l‚Äôanalyse**.

## M√©thodologie

L‚Äôanalyse des donn√©es a mis en √©vidence :
- l‚Äô**observation globale** de l‚Äô√©volution de la COVID-19 dans les pays du monde,
- une **proportionnalit√© par rapport au nombre d‚Äôhabitants**,
- puis une **observation concentr√©e sur les cinq pays d‚ÄôEurope** s√©lectionn√©s.

Pour mener √† bien notre √©tude, nous avons divis√© la t√¢che de travail en diff√©rents **niveaux d‚Äôanalyse** :

- **Une analyse d‚Äô√©volution temporelle** portant sur l‚Äô√©volution du nombre de cas de COVID d√©tect√©s.
- **Une analyse comparative** permettant de mettre en √©vidence :
  - la diff√©rence du nombre de cas d√©tect√©s entre les pays,
  - le **taux lin√©aire** d‚Äô√©volution.
- **Des indices d‚Äôindicateurs** pour illustrer l‚Äôimpact des **mesures anti-COVID-19** sur l‚Äô√©volution du virus, en corr√©lation avec le **niveau de rigueur** propre √† chaque pays.
- **Une analyse post-COVID-19**.

## Source des donn√©es

Les donn√©es utilis√©es proviennent du d√©p√¥t GitHub de *Our World In Data*, accessible √† l‚Äôadresse suivante :  
<https://github.com/owid/covid-19-data/tree/master/public/data>  
Le fichier README de ce d√©p√¥t fournit des pr√©cisions sur les sources et la structure des donn√©es.

## Sources d'information

- *Our World In Data* : <https://ourworldindata.org/coronavirus>  
- L‚Äôarticle d√©di√© aux cas de COVID-19 : <https://ourworldindata.org/covid-cases> d'OWID 
- **Google** : utilis√© pour la v√©rification des donn√©es et des tendances r√©elles, en compl√©ment de nos r√©sultats  
- **ChatGPT** : pour la validation des informations ainsi que pour la r√©solution d‚Äôerreurs et de bugs dans le code, proposition de graphe adapt√© √† une √©tude

## Packages √† installer (√† d√©commenter au besoins) :
```{r}
# install.packages(c(
#   "rnaturalearthhires",   # Cartographie haute r√©solution
#   "rnaturalearth",        # Donn√©es g√©ographiques de base
#   "rnaturalearthdata",    # Donn√©es g√©opolitiques compl√©mentaires
#   "sf",                   # Donn√©es spatiales (cartes)
#   "htmlwidgets",          # Widgets HTML interactifs
#   "plotly",               # Graphiques interactifs
#   "ggplot2",              # Visualisation de donn√©es
#   "tidyverse"             # Manipulation et traitement de donn√©es
# ))

```

  
```{r}
library(tidyverse)
library(ggplot2)
library(plotly)
library(htmlwidgets)
library(dplyr)
library(sf)
library(rnaturalearthdata)
library(rnaturalearth)
library(rnaturalearthhires)

#library(gridExtra)
library(scales)
#library(shiny)
```



#  Chargement, Exploration, Pr√©paration et nettoyage des donn√©es
##  Chargement
```{r}
CovidData <- read.csv("../data/owid-covid-data.csv", sep = ",")
#CovidData %>% head(10)
```

##  V√©rification et convertions des types de variables

```{r}
#str(CovidData)
```
### Conversion de la date et des variables cat√©gorielles
```{r}
CovidData$date <- as.Date(CovidData$date)
CovidData$continent <- as.factor(CovidData$continent)
CovidData$location <- as.factor(CovidData$location)
CovidData$iso_code <- as.factor(CovidData$iso_code)
#str(CovidData)
```
##  Suppression des colonnes avec plus de 90 % de valeurs manquantes
toutes les colonnes contenant plus de 90% de valeurs manquantes (NA) ont √©t√© retir√©es. Leurs noms sont conserv√©s dans une variable colonnes_supprimees √† des fins de tra√ßabilit√©.
```{r}
na_ratio <- colMeans(is.na(CovidData))

colonnes_supprimees <- names(na_ratio[na_ratio > 0.9])

CovidData_clean <- CovidData[, !(names(CovidData) %in% colonnes_supprimees)]
```
### Colonnes Supprim√©s : 
```{r}
colonnes_supprimees
```

##  D√©tection, traitement et suppression des doublons
### - Detectetion
#### Nous avons d√©tect√© 7 770 doublons sur la combinaison location + date. Ces doublons n'√©taient pas de simples r√©p√©titions, mais souvent deux lignes contenant des donn√©es partielles. C'EST DES DONNEES FRAGMENTEES

```{r}
doublons <- CovidData_clean %>%
  filter(duplicated(select(., location, date)) | duplicated(select(., location, date), fromLast = TRUE))


doublons <- doublons %>% arrange(location, date)
#doublons
```
###  Traitement des doublons
#### On a fusionn√© chaque groupe de doublons (location, date) en une seule ligne, en conservant Pour chaque colonne, la valeur non manquante (non-NA) si elle existe. Si les deux valeurs sont NA, le NA est conserv√©
```{r}
fusionnes <- doublons %>%
  group_by(location, date) %>%
  summarise(across(everything(), ~ first(na.omit(.))), .groups = "drop")
```

###  Suppression des doublons apr√®s fusion
#### Suppression des anciennes lignes doubl√©es du jeu de donn√©es initial + Ajout des lignes fusionn√©es √† leur place
```{r}
CovidData_sans_doublons <- CovidData_clean %>%
  filter(!(paste(location, date) %in% paste(doublons$location, doublons$date)))

CovidData_clean <- bind_rows(CovidData_sans_doublons, fusionnes) %>%
  arrange(location, date)

#CovidData_clean
```

##  ReV√©rification des donees et Chargement dans CovidData_Prepared (variable avec laquelle on va travailler tout le long)
```{r}
#str(CovidData_clean)
#summary(CovidData_clean)
CovidData_Prepared <- CovidData_clean
```

##  Ajout d'une colonne type_location qui indique selon une location si c'est un Pays, un Continent, un territoires ou d√©pendances, une aggregation -- Total location = 255

```{r}
ListeLocation <- CovidData_Prepared %>% select(location) %>% distinct()
#ListeLocation
```

```{r}
continents <- c("Africa", "Asia", "Europe", "North America",
    "South America", "Oceania")
```

```{r}
regions_agregats <- c(
    "World", "European Union (27)", 
    "High-income countries", "Low-income countries",
    "Lower-middle-income countries", "Upper-middle-income countries"
  )
```

```{r}
territory_or_dependency <- c(
      "England", "Scotland", "Wales", "Northern Ireland", "Puerto Rico", 
      "Hong Kong", "Macao", "Greenland", "Guadeloupe", "Martinique", 
      "French Guiana", "French Polynesia", "Reunion", "Mayotte", "New Caledonia", 
      "Aruba", "Curacao", "Bonaire Sint Eustatius and Saba", "Gibraltar", 
      "Guernsey", "Jersey", "Isle of Man", "Faroe Islands", "Falkland Islands", 
      "Saint Martin (French part)", "Sint Maarten (Dutch part)", "Saint Barthelemy", 
      "Saint Pierre and Miquelon", "Cayman Islands", "Bermuda", "British Virgin Islands", 
      "United States Virgin Islands", "Turks and Caicos Islands", "Anguilla", 
      "Montserrat", "Cook Islands", "Tokelau", "Niue", "Pitcairn", "Western Sahara", 
      "Palestine", "Kosovo", "Northern Cyprus", "Taiwan", "Vatican", 
      "Micronesia (country)")
```

```{r}
CovidData_Prepared <- CovidData_Prepared %>%
  mutate(type_location = case_when(
    location %in% continents ~ "continent",
    location %in% regions_agregats ~ "region_or_aggregate",
    location %in% territory_or_dependency ~ "territory_or_dependency",
    .default = "country"
  ))
#CovidData_Prepared
```

```{r}
#CovidData_Prepared %>% select(location, type_location) %>% distinct()
```

```{r}
#CovidData_Prepared %>% filter(location == 'France') %>% select(location, date, new_cases, new_cases_smoothed)
```


#  Analyses des donn√©es

###  Nombre total de cas COVID-19 par pays sur la carte
```{r message=FALSE, warning=FALSE}
summary_world <- CovidData_Prepared %>%
  filter(type_location %in% c("country", "territory_or_dependency")) %>%
  group_by(iso_code) %>%
  summarize(
    total_cases = max(total_cases, na.rm = TRUE),
    total_deaths = max(total_deaths, na.rm = TRUE)
  )

# chargergement de la g√©ographie du monde, utilisation du package "rnaturalearth"
world <- ne_countries(scale = "medium", returnclass = "sf")

# Fusion avec les donn√©es COVID
world_merged <- world %>%
  left_join(summary_world, by = c("iso_a3" = "iso_code")) %>%
  mutate(
    total_cases = ifelse(is.na(total_cases), 0, total_cases),
    total_deaths = ifelse(is.na(total_deaths), 0, total_deaths)
  )

# creation du graphe ggplot
p <- ggplot(data = world_merged) +
  geom_sf(aes(
    fill = total_cases,
    text = paste(
      name,
      "<br>Cas totaux :", formatC(total_cases, format = "d", big.mark = " "),
      "<br>D√©c√®s totaux :", formatC(total_deaths, format = "d", big.mark = " ")
    )
  ),
  color = "white", size = 0.2
  ) +
  scale_fill_viridis_c(
    option = "plasma",
    trans = "log10",  
    na.value = "grey90",
    labels = scales::label_number(
      accuracy = 1,
      big.mark = " ",
      scale_cut = scales::cut_short_scale()
    )
  ) +
  labs(
    title = "R√©partition mondiale des cas totaux de COVID-19",
    fill = "Nombre de cas cumul√©s"
  ) +
  theme_minimal()

# G√©n√©reratio de la version interactive
interactive_map <- ggplotly(p, tooltip = "text")

# Affichage dans un navigateur
temp_file <- tempfile(fileext = ".html")
saveWidget(interactive_map, temp_file)
browseURL(temp_file)

p
```

#### Interpretention : 
  **Le Graphe**  
Ce graphique montre la r√©partition mondiale des cas cumul√©s de COVID-19, avec un code couleur allant du violet (peu de cas) au jaune vif (tr√®s grand nombre de cas, jusqu'√† 100 millions).

- **En jaune** : les pays ayant enregistr√© le plus grand nombre de cas cumul√©s (ex : √âtats-Unis, Inde, Br√©sil, France).
- **En orange/rouge** : pays avec plusieurs millions de cas (ex : Canada, Espagne, Afrique du Sud, Russie).
- **En violet fonc√©** : pays ayant relativement peu de cas d√©clar√©s (ex : beaucoup de pays d‚ÄôAfrique centrale, quelques pays d‚ÄôAsie du Sud-Est).

  **Interpr√©tation concr√®te**  
Les pays les plus industrialis√©s et les plus peupl√©s pr√©sentent souvent les nombres de cas les plus √©lev√©s, mais disposent √©galement d‚Äôune capacit√© de d√©pistage plus importante.

L‚ÄôAfrique appara√Æt majoritairement en violet ou rouge fonc√© : cela peut traduire un nombre r√©el de cas plus faible, ou un sous-d√©pistage (moins de tests, moins de donn√©es disponibles).

Certains pays, comme la Chine ou la Cor√©e du Nord, peuvent sembler moins touch√©s, mais cela peut aussi r√©sulter des politiques de d√©claration ou d‚Äôun manque de transparence dans les donn√©es.

Le graphique ne refl√®te pas uniquement la gravit√© de la situation sanitaire, mais aussi les capacit√©s de test, les politiques de sant√© publique et la d√©mographie. Il permet de visualiser rapidement les zones les plus touch√©es en nombre absolu.


###  √âvolution Mondiale des Cas et des D√©c√®s de COVID-19 
```{r fig.width=12, fig.height=8}
world_long <- CovidData_Prepared %>%
  filter(location == "World") %>%
  select(date, new_cases_smoothed, new_deaths_smoothed) %>%
  pivot_longer(cols = c(new_cases_smoothed, new_deaths_smoothed),
               names_to = "type", values_to = "valeur") %>%
  mutate(
    type = recode(type,
                  new_cases_smoothed = "Nouveaux cas par jour (jours liss√© sur 7 jours)",
                  new_deaths_smoothed = "Nouveaux d√©c√®s par jour (jours liss√© sur 7 jours)")
  )

a <- ggplot(world_long, aes(x = date, y = valeur)) +
  geom_line(aes(color = type), size = 0.2) +
  facet_wrap(~type, ncol = 1, scales = "free_y") +
  
  # AXE X 
  scale_x_date(
    date_breaks = "3 months",
    date_labels = "%d %b %Y",
    date_minor_breaks = "1 month"
  ) +
  
  # AXE Y 
  scale_y_continuous(
    labels = comma,
    minor_breaks = waiver()
  ) +
  
  scale_color_manual(values = c(
    "Nouveaux cas par jour (jours liss√© sur 7 jours)" = "steelblue",
    "Nouveaux d√©c√®s par jour (jours liss√© sur 7 jours)" = "firebrick"
  )) +
  
  labs(
    title = "√âvolution Mondiale des Cas et des D√©c√®s de COVID-19 du 05/01/2020 au 04/08/2024 (Total de Cas : 775 866 783    -  Total de morts : 7 057 132)",
    subtitle = "",
    x = "Jours",
    y = "Nombre de Personne",
    caption = "Source : Our World in Data"
  ) +
  
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", size = 10),
    plot.subtitle = element_text(size = 8),
    
    # AXES
    axis.title.x = element_text(face = "bold", size = 10),
    axis.title.y = element_text(face = "bold", size = 10),
    axis.text.x = element_text(angle = 45, hjust = 1, size = 9),
    axis.text.y = element_text(size = 9),
    
    # GRILLE PRINCIPALE
    panel.grid.major = element_line(color = "grey80", size = 0.3),
    
    # GRILLE SECONDAIRE 
    panel.grid.minor = element_line(color = "grey90", size = 0.1),
    
    # FACETTES
    strip.background = element_rect(fill = "grey95", color = "grey80"),
    strip.text = element_text(face = "bold", size = 10),
    
    # BORDURE
    panel.border = element_rect(color = "grey60", fill = NA, size = 0.5),
    
    # L√âGENDE
    legend.position = "bottom",
    legend.title = element_blank(),
    legend.text = element_text(size = 10)
  )

# graphique interactif
interactive_plot <- ggplotly(a)

# Sauvegarde dans un fichier temporaire
temp_file <- tempfile(fileext = ".html")
saveWidget(interactive_plot, temp_file)

# Ouvre dans le navigateur
browseURL(temp_file)

# Affichage
a

```


## Analyse comparative de l'evolution de la Covid 19 dans les 5 pays d'Europe les plus impact√©s

### r√©cup√©rerer les 5 pays d'europe les plus touch√©es par le covid-19 en se basant sur le nombre total de cas enregister pour chaque pays

```{r fig.width=12, fig.height=8}

# la liste des 5 pays les plus touch√©s et leurs totals de cas  

top5EuropeanContaminedCountries <-CovidData_Prepared %>%
  filter(type_location %in% c("country","territory_or_dependency"), continent =="Europe") %>%
  group_by(location) %>%
  summarize(max_cases = max(total_cases, na.rm = TRUE)) %>% arrange((desc(max_cases)))%>% slice(1:5)
#top5EuropeanContaminedCountries

# filtre de la dataset sur ces 5 pays

top_5_countriesName<-top5EuropeanContaminedCountries$location

data_top5_contamined_countries <-CovidData_Prepared %>%
  filter(location %in% top_5_countriesName)
#data_top5_contamined_countries
```


###  Le graphe repr√©sentant nombre moyen par jour de nouveaux cas enregist√© pour les 5 pays les plus touch√©s d'Europe

```{r fig.width=12, fig.height=8, message=FALSE, warning=FALSE}
library(ggplot2)
library(plotly)
library(dplyr)

# Liste des pays top 5
top5 <- unique(data_top5_contamined_countries$location)

# Construction du graphique ggplot
p <- ggplot(
  data = data_top5_contamined_countries,
  aes(x = date, y = new_cases_smoothed, color = location, group = location)
) +
  geom_line(linewidth = 0.8) +
  scale_y_continuous(labels = scales::comma) +
  scale_x_date(date_breaks = "3 months", date_labels = "%d %b %Y") +
  labs(
    title = "Nombre moyen par jour de nouveaux cas enregistr√©s pour les 5 pays les plus touch√©s d'Europe",
    x = "Date",
    y = "Nombre moyen par jour de nouveaux cas",
    color = "Pays"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = "bottom"
  )

# Conversion en version interactive
interactive_plot <- ggplotly(p)

# Affichage dans un navigateur
temp_file <- tempfile(fileext = ".html")
saveWidget(interactive_plot, temp_file)
browseURL(temp_file)
p

```

#### √âvolution de la pand√©mie dans cinq pays europ√©ens

Nous observons l‚Äô√©volution de la pand√©mie pour chacun des cinq pays, ind√©pendamment les uns des autres.

Les cinq pays d‚ÄôEurope les plus touch√©s par la pand√©mie sont :
- **France** : 20 % du taux de contamination en Europe
- **Allemagne** : 19 %
- **Italie** : 13 %
- **Royaume-Uni** : 12 %
- **Russie** : 10 %

Le taux global de contamination dans ces pays repr√©sente environ **72 %** de l‚Äôensemble des cas d√©tect√©s en Europe.

---

- Analyse par pays

- ‚Ä¢ France
En d√©but 2020, on observe une tendance moyennement importante du nombre de cas d√©tect√©s, qui prend une proportion non n√©gligeable en octobre 2020. Cette tendance reste constante jusqu‚Äô√† octobre 2021 o√π l‚Äôon observe une croissance rapide du nombre de cas.

Le nombre de nouveaux cas quotidiens a atteint son pic fin 2021 et d√©but 2022, fr√¥lant les **350 000 cas par jour**, d√©passant largement les vagues pr√©c√©dentes. Durant le deuxi√®me trimestre de l‚Äôann√©e 2022, une chute importante du nombre de cas est observ√©e. Depuis, la situation s‚Äôam√©liore progressivement, bien qu'on note encore quelques petites vagues entre la fin du deuxi√®me trimestre 2022 et 2023. √Ä la fin de 2023, le nombre de cas s‚Äôest stabilis√© √† un niveau assez bas, jusqu‚Äô√† devenir **n√©gligeable d√©but 2024**.

- ‚Ä¢ Allemagne
L‚ÄôAllemagne a √©galement connu une forte vague d√©but 2022, avec un pic autour de **200 000 cas par jour**. Par la suite, plusieurs vagues, moins importantes, se sont succ√©d√©. La courbe des contaminations est rest√©e fluctuante, mais la **tendance g√©n√©rale est √† la baisse √† partir de 2023**.

- ‚Ä¢ Italie
En d√©but 2020, une tendance mod√©r√©ment importante du nombre de cas d√©tect√©s est observ√©e, qui augmente significativement en octobre 2020. Cette tendance reste stable jusqu‚Äô√† octobre 2021, moment o√π la croissance des cas s‚Äôacc√©l√®re.

Ce sch√©ma ressemble √† celui de la France, avec un pic important d√©but 2022, atteignant pr√®s de **180 000 cas quotidiens**. Entre 2020 et 2023, plusieurs vagues se sont succ√©d√©, atteignant **100 000 cas entre juin et ao√ªt 2022**, mais leur intensit√© a diminu√© avec le temps, montrant un **meilleur contr√¥le de la situation**.

- ‚Ä¢ Royaume-Uni
Un pic tr√®s √©lev√© a √©t√© enregistr√© d√©but 2022, avec pr√®s de **200 000 cas quotidiens**. Ensuite, les cas chutent rapidement, avec seulement quelques petites vagues par la suite. D√®s 2023, la courbe diminue fortement et les nouveaux cas deviennent **quasiment inexistants en 2024**, signe d‚Äôune sortie progressive de la crise.

- ‚Ä¢ Russie
Les pics √©pid√©miques sont plus √©tal√©s et **moins √©lev√©s** qu‚Äôen France ou en Allemagne. Le pic le plus marqu√© atteint environ **150 000 cas par jour**. Apr√®s la mi-2023, la courbe devient presque plate, ce qui pourrait s‚Äôexpliquer par une **baisse r√©elle de la circulation du virus** ou une **modification dans la mani√®re de tester et de rapporter les cas**.



###  Le graphe repr√©sentant nombre moyen par jour de nouveaux d√©c√©s enregist√© pour les 5 pays les plus touch√©s d'Europe

```{r fig.width=12, fig.height=8}


# Graphique de l'√©volutions moyen par jour des nouveaux d√©c√©s confirm√©s pour les 5 pays Europe les plus touch√©s

p1 <- ggplot(data_top5_contamined_countries, aes(x = date, y = new_deaths_smoothed, color = location)) +
  geom_line(size = 0.4) +
  
  # AXES
  scale_x_date(
    date_breaks = "3 months",
    date_labels = "%d %b %Y",
    date_minor_breaks = "1 month"
  ) +
  scale_y_continuous(
    labels = scales::comma
  ) +
  
  # TITRES ET LIBELL√âS
  labs(
    title = "Nombre moyens par jour de nouveaux d√©c√©s enregist√© pour les 5  pays les plus touch√©s d'Europe sur toute la p√©riode",
    x = "Date",
    y = "Nombre moyen par jour de nouveaux de d√©c√©s"
  ) +
  
  # TH√àME G√âN√âRAL
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold", size = 14, hjust = 0.5),
    axis.title = element_text(size = 12),
    axis.text.x = element_text(angle = 45, hjust = 1, size = 10),
    axis.text.y = element_text(size = 10),
    
    # GRILLE
    panel.grid.major = element_line(color = "gray80", size = 0.3),
    panel.grid.minor = element_line(color = "gray90", size = 0.2, linetype = "dotted"),
    
    # L√âGENDE
    legend.position = "bottom"
  )




# Cr√©e le graphique interactif
interactive_plot <- ggplotly(p1)

# Sauvegarde dans un fichier temporaire
temp_file <- tempfile(fileext = ".html")
saveWidget(interactive_plot, temp_file)

# Ouvre dans le navigateur
browseURL(temp_file)

p1

```

#### Interpretation
üá´üá∑ **France**  
En France, trois grandes vagues de d√©c√®s se distinguent. La premi√®re a lieu entre mi-avril et mi-mai, avec un pic proche de 500 morts par jour. La deuxi√®me, survenue √† la fin de l‚Äôann√©e 2020, est la plus importante, atteignant environ 800 d√©c√®s quotidiens. La troisi√®me, d√©but 2022, avoisine les 300 morts par jour, malgr√© une nette baisse observ√©e les mois pr√©c√©dents. Par la suite, chaque nouvelle vague de COVID-19 entra√Æne une hausse de mortalit√© moins marqu√©e.

üá©üá™ **Allemagne**  
L‚Äô√©volution en Allemagne est similaire √† celle observ√©e en France, avec un pic notable fin d√©cembre 2021, autour de 900 d√©c√®s par jour. Les vagues suivantes sont plus fr√©quentes mais moins intenses, avec une mortalit√© qui s‚Äô√©tale davantage dans le temps. √Ä partir de la mi-2022, les augmentations deviennent moins fortes, bien que la courbe reste plus irr√©guli√®re et prolong√©e que dans d‚Äôautres pays.

üáÆüáπ **Italie**  
L‚ÄôItalie est l‚Äôun des premiers pays touch√©s, avec une premi√®re vague particuli√®rement meurtri√®re d√®s mars-avril 2020, atteignant pr√®s de 800 morts par jour. Une nouvelle vague significative appara√Æt en d√©cembre 2020. Ensuite, la mortalit√© diminue, m√™me si les vagues continuent de se succ√©der.

üá∑üá∫ **Russie**  
La Russie se distingue par des pics de mortalit√© tr√®s √©lev√©s et plus durables que dans les autres pays. Le pic maximal est enregistr√© en novembre 2021, avec plus de 1 200 morts par jour. Contrairement √† l‚ÄôEurope de l‚ÄôOuest, la Russie reste confront√©e √† une mortalit√© √©lev√©e sur une p√©riode prolong√©e.

üá¨üáß **Royaume-Uni**  
Le Royaume-Uni conna√Æt deux pics majeurs de d√©c√®s : le premier en janvier 2021, avec pr√®s de 1 400 morts par jour ‚Äî un record parmi les cinq pays analys√©s ‚Äî, et le second fin avril 2020, avec environ 1 200 d√©c√®s quotidiens. Apr√®s ces vagues, la mortalit√© chute rapidement. M√™me lors des vagues de contaminations en 2022, le nombre de d√©c√®s reste relativement faible.

**Synth√®se comparative**  
La comparaison entre les cinq pays montre que la mortalit√© li√©e √† la COVID-19 a culmin√© entre fin 2020 et d√©but 2021, avant la g√©n√©ralisation des campagnes de vaccination. Le Royaume-Uni et la Russie pr√©sentent des pics particuli√®rement √©lev√©s, tandis que l‚ÄôItalie se distingue par une premi√®re vague tr√®s pr√©coce d√®s mars 2020. √Ä partir de 2022, la tendance g√©n√©rale est √† la baisse de la mortalit√© dans tous les pays.

###  Evolution des personnes ayant re√ßu au moins une dose de vaccin
```{r fig.width=12, fig.height=8}
# Filtrer les colonnes utiles
donnees_vaccins <- CovidData_Prepared %>%
  filter(location %in% top_5_countriesName) %>%
  select(date, pays = location, personnes_vaccinees = people_vaccinated) %>%
  filter(!is.na(personnes_vaccinees)) %>%
  mutate(date = as.Date(date))

# Tracer le graphique avec ggplot2
gg1<- ggplot(donnees_vaccins, aes(x = date, y = personnes_vaccinees, color = pays)) +
  geom_line(linewidth = 0.5) +
  labs(
    title = "√âvolution du nombre de personnes vaccin√©es contre la COVID-19",
    x = "Date",
    y = "Cumul des Personnes Vaccin√©es",
    color = "Pays"
  ) +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
gg1

```

#### Interpretation

Les estimations de la population que nous utilisons pour calculer les param√®tres de mesure par habitant sont fond√©es sur la derni√®re r√©vision des **Perspectives d√©mographiques mondiales** des Nations Unies.

La vaccination a √©t√© r√©alis√©e dans tous les pays, impact√©s ou non par la pand√©mie, et est devenue une obligation n√©cessaire pour les conditions de d√©placement d‚Äôun pays √† un autre sur la p√©riode de **2020 √† 2024**.

L‚Äôobjectif de cette √©tude est d‚Äôanalyser la variation des doses administr√©es et la masse de population ayant re√ßu au moins une dose de vaccin, ainsi que l‚Äôimpact que ces mesures ont eu sur la propagation de la COVID-19.  
**Est-elle un facteur d‚Äô√©volution ou un frein ?**

Pour cela, nous allons observer le graphe d‚Äô√©volution du taux d‚Äôinjection en parall√®le du graphe d‚Äô√©volution de la pand√©mie.

- **1,3 milliard** de doses ont √©t√© administr√©es en Europe de **2021 √† 2024**.

Sur le graphe d‚Äô√©volution du nombre de personnes ayant re√ßu au moins une dose de vaccin, nous observons une croissance n√©gligeable de personnes vaccin√©es d√©but 2021. Cette tendance devient progressivement importante vers la fin du premier semestre 2021, pour atteindre un pic moyen au d√©but du premier trimestre 2022.

Apr√®s cette p√©riode, elle est rest√©e constante pour la **France, l‚ÄôAllemagne, l‚ÄôItalie** et le **Royaume-Uni**.  
Le nombre de personnes vaccin√©es en **Russie** a √©volu√© jusqu‚Äôau d√©but du premier trimestre 2023, puis est rest√© constant jusqu‚Äôen 2024.

###  Observation de l'√âvolution des cas et de l'indice de rigueur selons les 5 pays europeennes les plus touch√©s
#### Version sans interaction
```{r fig.width=12, fig.height=8, message=FALSE, warning=FALSE}

# Pr√©paration des donn√©es
data_long <- data_top5_contamined_countries %>%
  mutate(
    new_cases_smoothed_scaled = new_cases_smoothed,
    stringency_index_scaled = stringency_index * max(new_cases_smoothed, na.rm = TRUE) / 100
  ) %>%
  select(date, location, new_cases_smoothed_scaled, stringency_index_scaled) %>%
  pivot_longer(cols = c(new_cases_smoothed_scaled, stringency_index_scaled),
               names_to = "variable", values_to = "value")

# Graphique ggplot am√©lior√©
p <- ggplot(data_long, aes(x = date, y = value, color = variable)) +
  geom_line(size = 0.5) +
  facet_wrap(~location, scales = "free_y") +
  scale_color_manual(
    values = c(
      "new_cases_smoothed_scaled" = "#0072B2",
      "stringency_index_scaled" = "#D55E00"
    ),
    labels = c("Nouveaux cas", "Indice de rigueur (rescal√©)")
  ) +
  scale_y_continuous(labels = label_number(big.mark = " ", accuracy = 1)) +  # Format lisible
  labs(
    title = "√âvolution des cas et de l'indice de rigueur",
    subtitle = "Comparaison des nouveaux cas liss√©s et de l'indice de rigueur pour les pays les plus touch√©s",
    x = "Date",
    y = "Valeur (√©chelle adapt√©e)",
    color = "Mesure"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5, size = 18),
    plot.subtitle = element_text(hjust = 0.5, size = 13, margin = margin(b = 10)),
    axis.title = element_text(face = "bold"),
    axis.text.x = element_text(angle = 45, hjust = 1, size = 10),
    axis.text.y = element_text(size = 10),
    panel.grid.major = element_line(color = "grey85", size = 0.4),
    panel.grid.minor = element_blank(),
    strip.text = element_text(face = "bold", size = 12),
    legend.position = "bottom",
    legend.title = element_text(face = "bold"),
    legend.text = element_text(size = 11)
  )

# Conversion en graphique interactif
interactive_plot <- ggplotly(p, tooltip = c("x", "y", "color"))

# Affichage dans un navigateur
temp_file <- tempfile(fileext = ".html")
saveWidget(interactive_plot, temp_file)
browseURL(temp_file)

p
```




#### Version avec interaction
```{r fig.width=12, fig.height=8}
pays <- unique(data_top5_contamined_countries$location)

# Cr√©er une figure vide
fig <- plot_ly()

# Ajouter une courbe pour chaque pays, avec visibilit√© contr√¥l√©e
for (i in seq_along(pays)) {
  p <- pays[i]
  df_p <- data_top5_contamined_countries %>% filter(location == p)
  
  # Visibilit√© : uniquement France visible par d√©faut
  visible_flag <- if (p == "France") TRUE else FALSE
  
  fig <- fig %>%
    add_lines(data = df_p, x = ~date, y = ~new_cases_smoothed,
              name = "Nouveaux cas", yaxis = "y1", visible = visible_flag) %>%
    add_lines(data = df_p, x = ~date, y = ~stringency_index,
              name = "Indice de rigueur", yaxis = "y2", visible = visible_flag)
}

# Cr√©ation du menu d√©roulant
buttons <- lapply(seq_along(pays), function(i) {
  n <- length(pays)
  visibles <- rep(FALSE, n * 2)
  visibles[(2 * i - 1):(2 * i)] <- TRUE
  
  list(
    method = "restyle",
    args = list("visible", visibles),
    label = pays[i]
  )
})

# Finalisation du graphique
fig <- fig %>%
  layout(
    title = "√âvolution des cas et de l'indice de rigueur",
    
    xaxis = list(
      title = "Date",
      tickformat = "%d %b %Y",        # Format mois ann√©e
      dtick = "M3",                # Tick principal tous les 3 mois
      tick0 = min(data_top5_contamined_countries$date),# Point de d√©part
      showgrid = TRUE,
      gridcolor = "lightgrey",     # Ligne principale
      minor = list(
        ticks = "inside",
        dtick = "M1",              # Tick secondaire tous les mois
        showgrid = TRUE,
        gridcolor = "gainsboro",   # Ligne secondaire plus fine
        ticklen = 2
      )
    ),
    
    yaxis = list(
      title = "Nouveaux cas (liss√©s)",
      showgrid = TRUE,
      gridcolor = "lightgrey",
      zeroline = FALSE,
      minor = list(
        showgrid = TRUE,
        gridcolor = "gainsboro"
      )
    ),
    
    yaxis2 = list(
      overlaying = "y",
      side = "right",
      title = "Indice de rigueur (rescal√©)",
      showgrid = FALSE
    ),
    
    updatemenus = list(list(
      active = which(pays == "France") - 1,
      buttons = buttons,
      direction = "down",
      x = 1.1,
      y = 1
    )),
    
    legend = list(x = 0.1, y = -0.2, orientation = "h")
  )

# Cr√©e le graphique interactif
interactive_plot <- fig

# Sauvegarde dans un fichier temporaire
temp_file <- tempfile(fileext = ".html")
saveWidget(as_widget(interactive_plot), temp_file)

# Ouvre dans le navigateur
browseURL(temp_file)
```




#### Interpretation final :
On constate que la gestion de la pand√©mie de COVID-19 et l‚Äôapplication des mesures sanitaires ont diff√©r√© selon les pays europ√©ens √©tudi√©s. La France, l‚ÄôItalie, l‚ÄôAllemagne et le Royaume-Uni ont tous r√©agi de fa√ßon marqu√©e lors des pics de contamination, en adoptant des restrictions tr√®s strictes, avec des indices de rigueur pouvant atteindre 88 au Royaume-Uni, surtout durant les ann√©es 2020 et 2021. √Ä l‚Äôoppos√©, la Russie a adopt√© une attitude plus souple, son indice de rigueur d√©passant rarement 60, m√™me lors de vagues importantes, comme au d√©but de 2022. En Russie, il est aussi fr√©quent de voir les restrictions maintenues √† un niveau mod√©r√© pendant les pics, puis rapidement assouplies, parfois avant m√™me que la situation ne s‚Äôam√©liore r√©ellement. De mani√®re g√©n√©rale, √† partir de la mi-2022, tous ces pays ont progressivement lev√© les mesures, malgr√© quelques hausses du nombre de cas, ce qui refl√®te un changement de strat√©gie reposant davantage sur la vaccination, la gestion des h√¥pitaux et l‚Äôacceptation par la population. Cette analyse montre donc que chaque pays a adopt√© une approche diff√©rente pour faire face √† la pand√©mie, malgr√© un contexte mondial¬†similaire.

### Analyse comparative
Le suivi de l‚Äô√©volution de la COVID-19 dans les cinq pays europ√©ens les plus touch√©s ‚Äì France, Allemagne, Italie, Russie et Royaume-Uni ‚Äì montre des dynamiques vari√©es en termes de nombre de cas et de mortalit√©, influenc√©es par la progression des campagnes de vaccination. En d√©but de pand√©mie, chacun de ces pays a enregistr√© des pics importants de contamination, avec des tendances similaires jusqu‚Äô√† fin 2021, o√π la France et l‚ÄôItalie affichent des hausses rapides, culminant respectivement √† environ 350 000 et 180 000 cas quotidiens d√©but 2022, tandis que l‚ÄôAllemagne et le Royaume-Uni connaissent des pics proches de 200 000 cas par jour. La Russie, quant √† elle, pr√©sente des pics plus √©tal√©s et moins √©lev√©s, avec un maximum autour de 150 000 cas par jour. Ces variations s‚Äôexpliquent notamment par des diff√©rences dans la gestion de la crise et les capacit√©s de d√©pistage.

Avec le d√©ploiement massif de la vaccination d√®s 2021, une stabilisation puis une baisse des nouveaux cas s‚Äôobservent progressivement dans la majorit√© des pays √©tudi√©s. En France, Allemagne, Italie et Royaume-Uni, la couverture vaccinale atteint un plateau d√©but 2022, p√©riode √† partir de laquelle la courbe des contaminations amorce une diminution notable, signe d‚Äôune efficacit√© du vaccin √† freiner la transmission. La Russie diff√®re l√©g√®rement, avec une mont√©e de la vaccination plus tardive, jusqu‚Äôau d√©but de 2023, ce qui co√Øncide avec une baisse plus tardive des cas. La vaccination semble donc avoir jou√© un r√¥le cl√© non seulement en limitant le nombre d‚Äôinfections, mais aussi en att√©nuant l‚Äôintensit√© des vagues successives.

Cette tendance se retrouve dans l‚Äô√©volution de la mortalit√©. Les cinq pays ont connu des vagues majeures de d√©c√®s entre fin 2020 et d√©but 2021, avant la g√©n√©ralisation de la vaccination, avec des pics d√©passant parfois les 1 000 morts par jour, notamment en Russie et au Royaume-Uni o√π les chiffres sont particuli√®rement √©lev√©s. La France et l‚ÄôItalie ont suivi des trajectoires proches, marqu√©es par une forte mortalit√© au d√©but de la crise puis une diminution progressive des d√©c√®s. L‚ÄôAllemagne se distingue par des pics moins intenses mais plus prolong√©s dans le temps, certains s‚Äô√©talant jusqu‚Äôen 2023. En Russie, la mortalit√© √©lev√©e persiste plus longtemps, refl√©tant une gestion plus complexe de la pand√©mie. Le Royaume-Uni a connu les plus hauts sommets, avec pr√®s de 1 400 d√©c√®s quotidiens en janvier 2021, avant d‚Äôobserver une chute rapide de la mortalit√© √† partir de 2022. Globalement, la baisse significative des d√©c√®s dans tous ces pays √† partir de 2022 correspond √† l‚Äôaugmentation de la couverture vaccinale, ainsi qu‚Äô√† l‚Äôadoption de mesures sanitaires adapt√©es.

Ainsi, l‚Äôanalyse conjointe des cas et des d√©c√®s met en lumi√®re l‚Äôeffet positif des campagnes de vaccination sur le contr√¥le de la pand√©mie. Alors que les vagues de contamination ont pu √™tre fortes et fr√©quentes jusqu‚Äôau d√©but de 2022, la vaccination a permis de limiter la gravit√© des cas, conduisant √† une r√©duction progressive et durable du nombre de morts, m√™me si la dynamique exacte varie selon le contexte national et la strat√©gie sanitaire de chaque pays.

## Fait le 20/05/2025 
## Avec RMarkDown